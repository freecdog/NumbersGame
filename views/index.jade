extends layout

block headData
    title Numbers game #numbers_game (variation of Kniffel or Yahtzee)
    link(rel='image_src', href='http://jaric.ru/dice_Visual_Pharm.png')

block content
    p
    div(id="nameForm")

    div(id='menuPlayButton', class="menuElement menuPad")
        a(href="/ang", onclick='setSearchPlayersCount(1);') Singleplayer
    div(id='menuPlayButton', class="menuElement menuPad")
        a(href="/ang", onclick='setSearchPlayersForMultiplayer();') Multiplayer

    p
        div(class="menuElement")
            | (searching: #{onlineStatistics ? onlineStatistics.playersSearching : '0'})
    div(class="menuElement menuPad")
        a(href="/onlineStatistics") Online statistics
    div(class="menuElement menuPad")
        a(href="/configuration") Configuration
    div(class="menuElement menuPad")
        a(href="/rules") Rules
    div(class="menuElement menuPad")
        a(href="/about") About

    //- It looks like social buttons work only from real hosts (not localhost)
    p
    script(
        type='text/javascript',
        src='//yandex.st/share/share.js',
        charset='utf-8'
    )
    div(
        class='yashare-auto-init menuElement',
        data-yashareL10n='ru',
        data-yashareType='none',
        data-yashareTheme='counter',
        data-yashareQuickServices='vkontakte,odnoklassniki,twitter,facebook,gplus,moimir,pinterest',
        data-yashareDescription='Welcome to #numbers_game (variation of Kniffel or Yahtzee)',
        data-yashareLink='http://jaric.ru:33322/',
        data-yashareImage='http://jaric.ru/dice_Visual_Pharm.png'
    )

    p
        | &nbsp;

    script.
        function setSearchPlayersCount(count){
            localStorage.setItem("searchPlayersCount", count.toString());
        }
        function isNumber(n) {
            return !isNaN(parseFloat(n)) && isFinite(n);
        }
        function getSearchPlayersCount(){
            var defaultCount = '2';
            var localStorage = window.localStorage;
            if (!localStorage) return defaultCount;
            var searchPlayersCount = localStorage.getItem("searchPlayersCount");
            if (isNumber(searchPlayersCount)) {
                //searchPlayersCount = Math.floor(parseFloat(searchPlayersCount));
                return searchPlayersCount;
            } else return defaultCount;
        }
        function getMultiplayerPlayersCount(){
            var defaultCount = '2';
            console.warn(localStorage);
            if (!localStorage) return defaultCount;
            var searchPlayersCount = localStorage.getItem("multiplayerPlayersCount");
            console.warn(searchPlayersCount);
            if (isNumber(searchPlayersCount)) {
                //searchPlayersCount = Math.floor(parseFloat(searchPlayersCount));
                return searchPlayersCount;
            } else return defaultCount;
        }
        function setSearchPlayersForMultiplayer(){
            var multiplayerPlayersCount = getMultiplayerPlayersCount();
            setSearchPlayersCount(multiplayerPlayersCount);
        }
